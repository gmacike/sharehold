{% extends "warehouse/base.html" %}
{% load staticfiles %}

{% block content %}

<div class="jumbotron content pl-3">

  <form class="warehouse_search_form" action="{% url 'warehouse_index' %}" method="GET">
    <label for="filter_criteria">Ograniczenie listy</label>
    <div class="input-group">
      <div class="input-group-prepend">
        <button type="submit" class="save btn btn-primary btn-lg mt-0 mb-0 disabled">Szukaj</button>
      </div>
      <input type="text" class="form-control" id="filter_criteria" autofocus name="filter"
        placeholder="Podaj kryteria wyszukiwania" value={{ request.GET.filter }}>
    </div>
  </form>

  {% if perms.warehouse.add_container %}
    <a href="{% url 'container_create' pk=warehouse.pk %}">Dodaj tytuł katalogowy</a>
  {% endif %}

  <div class="container-fluid inventorylist">
    <div class="row no-gutters">
      <h2>Lista magazynowa:</h2>
    </div>

    <div class="row">
      {% regroup warehouse.containers.all by commodity.catalogueEntry as invitems_list %}
      {% for invitem in invitems_list %}
        <div class="col-4">
          <h4>{{ invitem.grouper.itemLabel }}</h4>
          {% for container in invitem.list %}
          {% with commodity=container.commodity %}
            <p>{{ commodity.desc|default:"Brak dodatkowych informacji o wydaniu." }}</p>
            <div class="row containerentry">
              <div class="col col-4">
                {% if commodity.getImage %}
                  <a href="{% url 'boardgame_edition_edit' pk=container.commodity.pk %}"><img class="img-responsive img-thumbnail" src="{{container.commodity.getImage.url}}"></a>
                {% else %}
                  <a href="{% url 'boardgame_edition_edit' pk=container.commodity.pk %}"><img class="img-responsive img-thumbnail" src="{% static 'noimage.png' %}"></a>
                {% endif %}
              </div>
              <div class="col col-8">
                <h5>Przypisanych do magazynu:</h5>
                <div class="row no-gutters justify-content-around">
                  {% if perms.warehouse.change_boardgamecontainer %}
                    <button type="button" class="btn btn-warning" onclick="contaier_total_inc ({{container.pk}})"><i class="material-icons md-36">remove_circle_outline</i></button>
                  {% endif %}
                  <p class="inventoryvolume">{{container.total}}</p>
                  {% if perms.warehouse.change_boardgamecontainer %}
                    <button type="button" class="btn btn-warning"><i class="material-icons md-36">add_circle_outline</i></button>
                  {% endif %}
                </div>
              </div>
              <h5>Dostępnych w magazynie: <span class="availablevolume">{{ container.available }}</span></h5>
                <p class="barcodetextfont w-100">{{ commodity.codeValue }}</p>
            </div>
          {% endwith %}
          {% empty %}
            <p>Brak egzemplarzy przedmiotu przypisanych do magazynu.</p>
          {% endfor %}
        </div>
      {% empty %}
        <p>Brak przedmiotów przypisanych do magazynu.</p>
      {% endfor %}
    </div>
  </div>

    <!-- <div class="jumbotron inventorylist row">
      {% for item in warehouse.catalogueItems %}
        <div class="d-flex flex-wrap col-md-3 col-sm-5 inventoryitem">
        {% for container in warehouse.containers.all %}
          <div class="row justify-content-between invcontainerlist">
            <div class="col containerinv">
              <p class="dupa">
                {% if container.commodity.desc %}
                  {{ container.commodity.desc }}
                {% else %}
                  Brak dodatkowych informacji o wydaniu.
                {% endif %}
              </p>
              {% if container.commodity.getImage %}
                <a class="w-50" href="{% url 'boardgame_edition_edit' pk=container.commodity.pk %}"><img class="img-responsive img-thumbnail" src="{{container.commodity.getImage.url}}"></a>
              {% else %}
                <a class="w-50" href="{% url 'boardgame_edition_edit' pk=container.commodity.pk %}"><img class="img-responsive img-thumbnail" src="{% static 'noimage.png' %}"></a>
              {% endif %}
            </div>
          </div>
        {% endfor %}
        </div>
      {% endfor %}
    </div>

    <div class="w-100"></div> -->
</div>

{% endblock %}
